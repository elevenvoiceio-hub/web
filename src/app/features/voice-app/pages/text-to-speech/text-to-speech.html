<div class="h-full flex flex-col">
  <div class="component-heading">
    <h1>Text to Speech</h1>
  </div>

  <main class="flex h-full flex-col lg:flex-row gap-4 min-w-0">
    <div class="flex h-full shrink grow flex-col min-h-0 min-w-0">
      <form
        action=""
        class="flex h-full w-full shrink grow flex-col p-4 lg:max-h-140 lg:w-auto lg:p-6 min-w-0"
      >
        <div class="shrink grow">
          <div class="relative flex size-full flex-col gap-2 min-h-0">
            <textarea
              class="min-h-15 w-full p-4 pb-20 lg:pb-16 lg:max-h-128 bg-muted size-full resize-none wrap-break-word"
              hlmInput
              placeholder="Begin by typing your text or simply paste the content you wish to transform into natural-sounding speech."
              rows="4"
              [(ngModel)]="text"
              name="text"
              [maxlength]="textareaMaxLength"
            ></textarea>

            <div
              class="absolute lg:static bottom-0 lg:bottom-auto z-50 flex w-full items-center justify-between px-4 py-2 lg:px-0 lg:py-0"
            >
              <button
                type="button"
                hlmBtn
                variant="secondary"
                class="bg-accent hover:bg-accent/60"
              >
                {{ text.length ? 'Clear text' : 'Demo Text' }}
              </button>

              <div class="text-sm text-muted-foreground lg:text-base">
                {{ text.length
                }}/{{textareaMaxLength}}

              </div>
            </div>
          </div>
        </div>

        <div
          class="mt-2 flex w-full shrink-0 grow-0 flex-row flex-nowrap justify-between gap-2 lg:mt-6 items-center"
        >
          <div class="flex-1 min-w-0 overflow-hidden">
            <div class="flex items-center lg:gap-2 h-10 lg:h-12">
              <div class="w-full min-w-0 overflow-hidden">
                <app-tts-voices
                  class="w-full min-w-0 h-full"
                  [(selectedVoice)]="selectedVoice"
                  (selectVoice)="selectedVoice.set($event)"
                />
              </div>
            </div>
          </div>

          <div class="shrink-0 ml-1">
            <hlm-sheet side="right">
              <button
                brnSheetTrigger
                hlmBtn
                variant="ghost"
                type="button"
                class="shrink-0 min-w-0 h-10 lg:h-12 px-3 flex items-center justify-center lg:hidden"
              >
                <div class="flex items-center justify-center gap-2">
                  <ng-icon hlm name="lucideSettings" />
                  <span class="ml-1 text-sm whitespace-nowrap">Settings</span>
                </div>
              </button>
              <hlm-sheet-content
                *brnSheetContent="let ctx"
                class="w-[20rem] max-w-full p-4"
              >
                <app-tts-settings
                  [overlay]="true"
                  [(emotion)]="emotion"
                  [(model)]="model"
                  [emotions]="emotions"
                  [models]="models"
                  [(textNormalization)]="textNormalization"
                  [(pitch)]="pitch"
                  [(speedRate)]="speedRate"
                />
              </hlm-sheet-content>
            </hlm-sheet>
          </div>

          <div class="shrink-0 ml-1 hidden lg:block">
            <button
              type="submit"
              [disabled]="text.length === 0"
              hlmBtn
              class="h-10 lg:h-12 px-4"
              (click)="generateSpeech()"
            >
              Generate Speech
            </button>
          </div>
        </div>

        <div class="mt-2 w-full lg:hidden">
          <button
            type="submit"
            [disabled]="text.length === 0"
            hlmBtn
            class="w-full min-w-0 justify-center h-10 lg:h-12"
            (click)="generateSpeech()"
          >
            Generate Speech
          </button>
        </div>
      </form>
    </div>

    <app-tts-settings
      class="hidden lg:block lg:flex-none lg:basis-[24rem] min-w-0 max-w-full"
      [(emotion)]="emotion"
      [(model)]="model"
      [emotions]="emotions"
      [models]="models"
      [(textNormalization)]="textNormalization"
      [(pitch)]="pitch"
      [(speedRate)]="speedRate"
    />
  </main>
</div>
